- name: setup direcrories
  become: true
  file:
    path: '{{ item }}'
    state: directory
    owner: "{{ ansible_user }}"
  loop:
    - /opt/var/ghq/src
    - /opt/var/go/bin
    - /opt/bin
- name: git clone dotfiles
  git:
    repo: ssh://git@github.com/cumet04/dotfiles.git
    dest: /opt/var/ghq/src/github.com/cumet04/dotfiles
    version: "{{ ansible_env.BRANCH | default('master') }}"
    update: no
    accept_hostkey: yes
- name: put shortcut for dotfiles
  file:
    src: /opt/var/ghq/src/github.com/cumet04/dotfiles
    dest: "{{ ansible_env.HOME }}/.dotfiles"
    state: link
- name: install dotfiles symlinks
  file:
    src: "{{ ansible_env.HOME }}/.dotfiles/home/{{ item }}"
    dest: "{{ ansible_env.HOME }}/{{ item }}"
    state: link
  loop:
    - .config
    - .gitconfig
    - .tigrc
- name: symlink shell_commands
  file:
    src: "{{ ansible_env.HOME }}/.dotfiles/shell_commands"
    dest: /opt/bin/shell_commands
    state: link
- name: symlink Documets (sync-workdir)
  file:
    src: /mnt/c/Users/medalhkr/Documents
    dest: "{{ ansible_env.HOME }}/Documents"
    state: link
- name: ignore gitconfig change
  shell: |
    cd /opt/var/ghq/src/github.com/cumet04/dotfiles
    git update-index --skip-worktree home/.gitconfig
